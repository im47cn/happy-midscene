# æ‰§è¡Œåˆ†æä»ªè¡¨æ¿ æŠ€æœ¯æ–¹æ¡ˆè®¾è®¡æ–‡æ¡£

## 1. é¡¹ç›®èƒŒæ™¯ä¸ç›®æ ‡

æµ‹è¯•æ‰§è¡Œäº§ç”Ÿå¤§é‡æ•°æ®ï¼Œä½†ç¼ºä¹æœ‰æ•ˆçš„åˆ†ææ‰‹æ®µä¼šå¯¼è‡´é—®é¢˜è¢«å¿½è§†ã€‚æœ¬æ¨¡å—é€šè¿‡æ•°æ®å¯è§†åŒ–å’Œæ™ºèƒ½åˆ†æï¼Œå¸®åŠ©ç”¨æˆ·å¿«é€Ÿå®šä½æµ‹è¯•é—®é¢˜ã€è¯„ä¼°æµ‹è¯•è´¨é‡ã€ä¼˜åŒ–æµ‹è¯•ç­–ç•¥ã€‚

## 2. ç³»ç»Ÿæ¶æ„è®¾è®¡

### 2.1 æ€»ä½“æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Analytics Dashboard                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚    Data      â”‚  â”‚   Analysis   â”‚  â”‚    Report    â”‚       â”‚
â”‚  â”‚  Collector   â”‚  â”‚    Engine    â”‚  â”‚  Generator   â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚         â”‚                 â”‚                 â”‚               â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                      â”‚                                       â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”                              â”‚
â”‚              â”‚  TimeSeries   â”‚                              â”‚
â”‚              â”‚   Storage     â”‚                              â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â–¼            â–¼            â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Dashboardâ”‚  â”‚  Charts  â”‚  â”‚  Alerts  â”‚
   â”‚    UI    â”‚  â”‚  Library â”‚  â”‚  System  â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 æŠ€æœ¯æ ˆé€‰å‹

* **æ•°æ®å­˜å‚¨**: IndexedDB + Dexie.js (ORM)
* **å›¾è¡¨åº“**: ECharts (ä¸°å¯Œçš„å›¾è¡¨ç±»å‹)
* **UI æ¡†æ¶**: React + TailwindCSS
* **çŠ¶æ€ç®¡ç†**: Zustand
* **æŠ¥å‘Šå¯¼å‡º**: jsPDF + html2canvas

---

## 3. æ•°æ®æ¨¡å‹è®¾è®¡

### 3.1 æ‰§è¡Œè®°å½•

```typescript
interface ExecutionRecord {
  id: string;
  caseId: string;                // å…³è”çš„ç”¨ä¾‹ ID
  caseName: string;              // ç”¨ä¾‹åç§°
  startTime: number;             // å¼€å§‹æ—¶é—´æˆ³
  endTime: number;               // ç»“æŸæ—¶é—´æˆ³
  duration: number;              // æ€»è€—æ—¶ (ms)
  status: 'passed' | 'failed' | 'skipped' | 'error';

  // æ­¥éª¤è¯¦æƒ…
  steps: StepRecord[];

  // å¤±è´¥ä¿¡æ¯
  failure?: {
    type: FailureType;
    message: string;
    stepIndex: number;
    screenshot?: string;         // Base64
  };

  // è‡ªæ„ˆä¿¡æ¯
  healing?: {
    attempted: boolean;
    success: boolean;
    strategy?: string;
  };

  // ç¯å¢ƒä¿¡æ¯
  environment: {
    browser: string;
    viewport: { width: number; height: number };
    url: string;
  };
}

interface StepRecord {
  index: number;
  description: string;
  status: 'passed' | 'failed' | 'skipped';
  duration: number;
  aiResponseTime?: number;       // AI å“åº”è€—æ—¶
  retryCount: number;
}

type FailureType =
  | 'locator_failed'
  | 'assertion_failed'
  | 'timeout'
  | 'network_error'
  | 'script_error'
  | 'unknown';
```

### 3.2 èšåˆæ•°æ®

```typescript
interface DailyStats {
  date: string;                  // YYYY-MM-DD
  totalExecutions: number;
  passed: number;
  failed: number;
  skipped: number;
  avgDuration: number;
  failuresByType: Record<FailureType, number>;
}

interface CaseStats {
  caseId: string;
  caseName: string;
  totalRuns: number;
  passRate: number;
  avgDuration: number;
  lastRun: number;
  stabilityScore: number;        // 0-100, è¶Šé«˜è¶Šç¨³å®š
  isFlakey: boolean;
  recentResults: ('passed' | 'failed')[];  // æœ€è¿‘ 10 æ¬¡ç»“æœ
}

interface HealthScore {
  overall: number;               // 0-100
  components: {
    passRate: number;
    stability: number;
    performance: number;
    coverage: number;
  };
  trend: 'improving' | 'stable' | 'declining';
}
```

---

## 4. æ ¸å¿ƒæ¨¡å—è®¾è®¡

### 4.1 æ•°æ®é‡‡é›†å™¨ (Data Collector)

```typescript
class DataCollector {
  private db: Dexie;

  async recordExecution(record: ExecutionRecord): Promise<void> {
    // å­˜å‚¨æ‰§è¡Œè®°å½•
    await this.db.executions.add(record);

    // æ›´æ–°æ¯æ—¥ç»Ÿè®¡
    await this.updateDailyStats(record);

    // æ›´æ–°ç”¨ä¾‹ç»Ÿè®¡
    await this.updateCaseStats(record);

    // æ£€æŸ¥å‘Šè­¦è§„åˆ™
    await this.checkAlerts(record);
  }

  private async updateDailyStats(record: ExecutionRecord): Promise<void> {
    const date = this.formatDate(record.startTime);
    const existing = await this.db.dailyStats.get(date);

    if (existing) {
      existing.totalExecutions++;
      existing[record.status]++;
      // æ›´æ–°å¹³å‡è€—æ—¶...
      await this.db.dailyStats.put(existing);
    } else {
      await this.db.dailyStats.add({
        date,
        totalExecutions: 1,
        passed: record.status === 'passed' ? 1 : 0,
        // ...
      });
    }
  }
}
```

### 4.2 åˆ†æå¼•æ“ (Analysis Engine)

```typescript
class AnalysisEngine {
  // è®¡ç®—å¥åº·åº¦è¯„åˆ†
  async calculateHealthScore(): Promise<HealthScore> {
    const recent = await this.getRecentStats(7); // æœ€è¿‘ 7 å¤©

    const passRate = this.calculatePassRate(recent);
    const stability = this.calculateStability(recent);
    const performance = this.calculatePerformance(recent);

    const overall = passRate * 0.4 + stability * 0.35 + performance * 0.25;

    return {
      overall: Math.round(overall),
      components: { passRate, stability, performance, coverage: 0 },
      trend: this.calculateTrend(recent),
    };
  }

  // è¯†åˆ« Flaky æµ‹è¯•
  async identifyFlakyTests(): Promise<CaseStats[]> {
    const cases = await this.db.caseStats.toArray();

    return cases.filter(c => {
      // å¦‚æœæœ€è¿‘ 10 æ¬¡ä¸­æœ‰é€šè¿‡ä¹Ÿæœ‰å¤±è´¥ï¼Œä¸”å¤±è´¥ç‡åœ¨ 20%-80% ä¹‹é—´
      const results = c.recentResults;
      const failCount = results.filter(r => r === 'failed').length;
      const failRate = failCount / results.length;

      return failRate > 0.2 && failRate < 0.8;
    });
  }

  // åˆ†æå¤±è´¥çƒ­ç‚¹
  async analyzeFailureHotspots(): Promise<Hotspot[]> {
    const failures = await this.db.executions
      .where('status').equals('failed')
      .limit(1000)
      .toArray();

    // æŒ‰å¤±è´¥æ­¥éª¤åˆ†ç»„ç»Ÿè®¡
    const stepFailures = new Map<string, number>();
    for (const f of failures) {
      if (f.failure) {
        const key = `${f.failure.stepIndex}:${f.steps[f.failure.stepIndex]?.description}`;
        stepFailures.set(key, (stepFailures.get(key) || 0) + 1);
      }
    }

    // æ’åºè¿”å› Top 10
    return Array.from(stepFailures.entries())
      .sort((a, b) => b[1] - a[1])
      .slice(0, 10)
      .map(([key, count]) => ({
        description: key.split(':')[1],
        failureCount: count,
        percentage: count / failures.length * 100,
      }));
  }
}
```

### 4.3 æŠ¥å‘Šç”Ÿæˆå™¨ (Report Generator)

```typescript
class ReportGenerator {
  async generateDailyReport(date: string): Promise<Report> {
    const stats = await this.analysisEngine.getDailyStats(date);
    const failures = await this.analysisEngine.getFailures(date);
    const hotspots = await this.analysisEngine.analyzeFailureHotspots();

    return {
      title: `æµ‹è¯•æ‰§è¡Œæ—¥æŠ¥ - ${date}`,
      summary: {
        totalExecutions: stats.totalExecutions,
        passRate: `${(stats.passed / stats.totalExecutions * 100).toFixed(1)}%`,
        avgDuration: `${(stats.avgDuration / 1000).toFixed(1)}s`,
      },
      failureAnalysis: {
        byType: stats.failuresByType,
        hotspots,
      },
      recommendations: this.generateRecommendations(stats, failures),
    };
  }

  async exportToPDF(report: Report): Promise<Blob> {
    const doc = new jsPDF();
    // æ¸²æŸ“æŠ¥å‘Šå†…å®¹...
    return doc.output('blob');
  }

  private generateRecommendations(stats: DailyStats, failures: any[]): string[] {
    const recommendations: string[] = [];

    if (stats.passed / stats.totalExecutions < 0.8) {
      recommendations.push('é€šè¿‡ç‡ä½äº 80%ï¼Œå»ºè®®æ£€æŸ¥å¤±è´¥ç”¨ä¾‹å¹¶ä¿®å¤');
    }

    if (stats.failuresByType.locator_failed > 5) {
      recommendations.push('å¤šä¸ªå®šä½å¤±è´¥ï¼Œå»ºè®®å¯ç”¨è‡ªæ„ˆåŠŸèƒ½æˆ–æ›´æ–°å…ƒç´ å®šä½');
    }

    return recommendations;
  }
}
```

---

## 5. UI ç»„ä»¶è®¾è®¡

### 5.1 ä»ªè¡¨æ¿å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“Š æµ‹è¯•åˆ†æä»ªè¡¨æ¿                    [ä»Šæ—¥] [7å¤©] [30å¤©] [è‡ªå®šä¹‰]â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ æ‰§è¡Œæ¬¡æ•°  â”‚ â”‚  é€šè¿‡ç‡   â”‚ â”‚ å¹³å‡è€—æ—¶  â”‚ â”‚  å¥åº·åº¦   â”‚          â”‚
â”‚  â”‚   127    â”‚ â”‚  89.7%   â”‚ â”‚  12.3s   â”‚ â”‚    85    â”‚          â”‚
â”‚  â”‚  â†‘ 12%   â”‚ â”‚  â†“ 2.1%  â”‚ â”‚  â†’ 0%    â”‚ â”‚  â†‘ 3     â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    æ‰§è¡Œè¶‹åŠ¿å›¾                           â”‚   â”‚
â”‚  â”‚    â–‚â–ƒâ–…â–†â–‡â–ˆâ–†â–…â–ƒâ–‚â–â–‚â–ƒâ–…â–†â–‡â–ˆâ–†â–…â–ƒâ–‚                              â”‚   â”‚
â”‚  â”‚    1  2  3  4  5  6  7  8  9  10 11 12 13 14          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   å¤±è´¥ç±»å‹åˆ†å¸ƒ       â”‚  â”‚        å¤±è´¥çƒ­ç‚¹                   â”‚ â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”             â”‚  â”‚  1. ç‚¹å‡»ç™»å½•æŒ‰é’® (23æ¬¡)           â”‚ â”‚
â”‚  â”‚   â”‚   â”‚  å®šä½ 45%   â”‚  â”‚  2. éªŒè¯æˆåŠŸæç¤º (18æ¬¡)           â”‚ â”‚
â”‚  â”‚   â””â”€â”€â”€â”˜             â”‚  â”‚  3. è¾“å…¥ç”¨æˆ·å (12æ¬¡)             â”‚ â”‚
â”‚  â”‚   â”Œâ”€â”               â”‚  â”‚  ...                             â”‚ â”‚
â”‚  â”‚   â””â”€â”˜  æ–­è¨€ 30%     â”‚  â”‚                                  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ç”¨ä¾‹åˆ—è¡¨                              [ç¨³å®š] [Flaky] [å…¨éƒ¨]â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚  ç”¨ä¾‹åç§°           é€šè¿‡ç‡    è€—æ—¶    ç¨³å®šæ€§   æœ€åæ‰§è¡Œ    â”‚   â”‚
â”‚  â”‚  ç”¨æˆ·ç™»å½•æµç¨‹       95%      8.2s    â¬¤ ç¨³å®š   2åˆ†é’Ÿå‰    â”‚   â”‚
â”‚  â”‚  å•†å“æœç´¢æµ‹è¯•       72%      15.1s   â¬¤ Flaky  1å°æ—¶å‰    â”‚   â”‚
â”‚  â”‚  è®¢å•æäº¤æµç¨‹       100%     22.3s   â¬¤ ç¨³å®š   3å°æ—¶å‰    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 å›¾è¡¨é…ç½®

```typescript
// æ‰§è¡Œè¶‹åŠ¿å›¾é…ç½®
const trendChartOption = {
  tooltip: { trigger: 'axis' },
  legend: { data: ['é€šè¿‡', 'å¤±è´¥'] },
  xAxis: {
    type: 'category',
    data: dates, // ['12-01', '12-02', ...]
  },
  yAxis: { type: 'value' },
  series: [
    {
      name: 'é€šè¿‡',
      type: 'bar',
      stack: 'total',
      data: passedCounts,
      itemStyle: { color: '#10B981' },
    },
    {
      name: 'å¤±è´¥',
      type: 'bar',
      stack: 'total',
      data: failedCounts,
      itemStyle: { color: '#EF4444' },
    },
  ],
};

// å¤±è´¥ç±»å‹é¥¼å›¾é…ç½®
const failureTypePieOption = {
  series: [{
    type: 'pie',
    radius: ['40%', '70%'],
    data: [
      { value: 45, name: 'å®šä½å¤±è´¥' },
      { value: 30, name: 'æ–­è¨€å¤±è´¥' },
      { value: 15, name: 'è¶…æ—¶' },
      { value: 10, name: 'å…¶ä»–' },
    ],
  }],
};
```

---

## 6. å‘Šè­¦ç³»ç»Ÿè®¾è®¡

```typescript
interface AlertRule {
  id: string;
  name: string;
  enabled: boolean;
  condition: AlertCondition;
  notification: NotificationConfig;
}

interface AlertCondition {
  type: 'pass_rate' | 'consecutive_failures' | 'duration' | 'flaky_detected';
  threshold: number;
  timeWindow?: number;           // æ—¶é—´çª—å£ (åˆ†é’Ÿ)
}

interface NotificationConfig {
  channels: ('browser' | 'email' | 'webhook')[];
  webhookUrl?: string;
  emailRecipients?: string[];
}

class AlertSystem {
  async checkAlerts(record: ExecutionRecord): Promise<void> {
    const rules = await this.getEnabledRules();

    for (const rule of rules) {
      if (await this.evaluateCondition(rule.condition, record)) {
        await this.sendNotification(rule, record);
      }
    }
  }

  private async evaluateCondition(
    condition: AlertCondition,
    record: ExecutionRecord
  ): Promise<boolean> {
    switch (condition.type) {
      case 'pass_rate':
        const rate = await this.calculateRecentPassRate(condition.timeWindow);
        return rate < condition.threshold;

      case 'consecutive_failures':
        const failures = await this.getConsecutiveFailures(record.caseId);
        return failures >= condition.threshold;

      // ...
    }
  }
}
```

---

## 7. å®æ–½è®¡åˆ’

1. **Week 1**: æ•°æ®æ¨¡å‹è®¾è®¡ï¼Œé‡‡é›†å™¨å®ç°ï¼Œå­˜å‚¨å±‚
2. **Week 2**: åˆ†æå¼•æ“æ ¸å¿ƒç®—æ³•ï¼Œå¥åº·åº¦è®¡ç®—
3. **Week 3**: UI ç»„ä»¶å¼€å‘ï¼Œå›¾è¡¨é›†æˆ
4. **Week 4**: æŠ¥å‘Šç”Ÿæˆï¼Œå‘Šè­¦ç³»ç»Ÿï¼Œæµ‹è¯•ä¼˜åŒ–
