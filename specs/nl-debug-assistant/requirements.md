# 自然语言调试助手 需求规格说明书

## 1. 引言

本功能旨在提供对话式的测试调试体验，用户可以使用自然语言询问测试失败原因、请求修复建议，以及执行调试操作。通过 AI 对话，将复杂的调试过程转化为简单的问答交互。

## 2. 术语定义

* **调试助手 (Debug Assistant)**: 基于 LLM 的对话式调试工具。
* **调试上下文 (Debug Context)**: 当前调试会话的完整信息，包括截图、日志、错误信息等。
* **修复建议 (Fix Suggestion)**: AI 基于分析给出的问题解决方案。
* **调试操作 (Debug Action)**: 用户通过对话触发的调试相关操作。

---

## 3. 功能需求 (Functional Requirements)

### 3.1 对话式调试 (Conversational Debugging)

* **当** 测试执行失败时，**系统** 应 自动激活调试助手并展示失败摘要。
* **系统** 必须 支持以下自然语言查询：

  **3.1.1 原因分析**
  - "为什么这一步失败了？"
  - "登录按钮点不了是什么原因？"
  - "这个断言为什么没通过？"

  **3.1.2 状态查询**
  - "当前页面是什么状态？"
  - "有没有弹窗挡住了元素？"
  - "页面加载完成了吗？"

  **3.1.3 元素分析**
  - "帮我找一下登录按钮在哪里"
  - "这个元素有什么属性？"
  - "页面上有几个可点击的按钮？"

  **3.1.4 修复建议**
  - "怎么修复这个问题？"
  - "有没有替代的定位方式？"
  - "应该等待多久？"

### 3.2 上下文感知 (Context Awareness)

* **系统** 必须 在对话中维护以下上下文：
  - 当前/历史截图
  - 执行日志
  - 错误堆栈
  - DOM 快照（如可用）
  - 测试脚本内容
  - 历史执行记录

* **系统** 应 根据对话内容自动补充相关上下文到 AI 提示中。

### 3.3 交互式调试操作 (Interactive Debug Actions)

* **系统** 必须 支持通过对话触发以下操作：

  **3.3.1 页面操作**
  - "帮我点击那个蓝色按钮"
  - "刷新一下页面"
  - "滚动到页面底部"
  - "在搜索框输入 'test'"

  **3.3.2 元素定位**
  - "高亮显示所有按钮"
  - "标记出登录表单"
  - "圈出第三个输入框"

  **3.3.3 截图分析**
  - "对比一下上次成功的截图"
  - "放大这个区域看看"
  - "标注出变化的部分"

  **3.3.4 日志检查**
  - "显示最近的错误日志"
  - "有没有网络请求失败？"
  - "控制台有什么警告？"

### 3.4 修复建议与执行 (Fix Suggestions & Execution)

* **当** AI 分析出问题原因后，**系统** 应 提供具体的修复建议：
  - 建议修改的代码/脚本
  - 建议添加的等待时间
  - 建议的替代定位方式

* **系统** 应 支持"一键应用"修复建议：
  - 自动更新测试脚本
  - 重试失败步骤
  - 记录修复历史

* **如果** 用户确认应用修复，**系统** 应 自动从失败点重新执行并反馈结果。

### 3.5 知识积累 (Knowledge Accumulation)

* **系统** 应 记录成功的调试案例：
  - 问题模式
  - 解决方案
  - 适用场景

* **当** 遇到相似问题时，**系统** 应 优先推荐历史成功方案。

### 3.6 多轮对话 (Multi-turn Conversation)

* **系统** 必须 支持多轮对话，记住对话历史和上下文。
* **系统** 应 支持对话中的指代消解（"它"、"那个"、"这里"）。
* **用户** 应 能够通过"清除对话"重新开始调试会话。

---

## 4. 非功能需求 (Non-Functional Requirements)

### 4.1 响应速度 (Response Time)

* **系统** 的普通查询响应时间应 < 5 秒。
* **系统** 的页面分析响应时间应 < 10 秒。

### 4.2 准确性 (Accuracy)

* **系统** 的问题原因分析准确率应 > 70%。
* **系统** 的修复建议有效率应 > 60%。

### 4.3 易用性 (Usability)

* **系统** 应 支持常见的调试问题快捷入口。
* **系统** 的对话界面应简洁，不遮挡页面主要内容。

---

## 5. 限制与假设 (Constraints & Assumptions)

* **假设**: 用户具备基本的测试概念，能理解元素、定位、断言等术语。
* **限制**: 复杂的业务逻辑问题可能超出 AI 分析能力。
* **限制**: 实时调试操作需要页面处于可交互状态。
